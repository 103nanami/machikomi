<container>
  <div class="row">
    <div class="col-lg-1">
    </div>

    <div class="col-lg-2">
      <div class="city_button">
        <%= link_to "街から探す", cities_path, class:"btn btn-info" ,style:"width:120px" %>
      </div>

      <div class="recomend">
        <p class="recomend_title">おすすめの投稿</p>
        <div class="recomend_post">
          <% @post_ranks.each do |post_rank| %>
            <%= link_to post_path(post_rank) do %>
              <%= attachment_image_tag post_rank, :image, style:"width:150px; height:auto;" %>
            <% end %>
            <%= post_rank.post.post_name %>
          <% end %>
        </div>
      </div>
    </div>

    <dv class="col-lg-7">

      <div class="post_title_box">
        <h4 class="post_title"><%= @post.post_name %></h4>
      </div>

      <div class="favorite">
        <% if @post.favorited_by?(current_user) %>
          <p>
            <%= link_to post_favorites_path(@post), method: :delete do %>
              ♥<%= @post.favorites.count %> いいね
            <% end %>
          </p>
        <% else %>
          <p>
            <%= link_to post_favorites_path(@post), method: :post do %>
              ♡<%= @post.favorites.count %> いいね
            <% end %>
          </p>
        <% end %>
      </div>

      <div class="post_main_box">
        <%= attachment_image_tag @post, :image, style:"width:600px; height:auto;" %>
        <div class="post_text">
          <%= @post.post_text %>
        </div>

        <div id="googlemap"></div>


        <div class="comment_all">
          <p>コメント件数：<%= @post.comments.count %></p>
          <% @post.comments.each do |comment| %>
            <p><%= image_tag('sample-author1.jpg') %></p>
            <%= comment.user.name %>
            <%= comment.created_at.strftime('%Y/%m/%d') %><%= comment.comment %>
            <% if comment.user == current_user %>
              <div>
                <%= link_to "削除", post_comments_path(@post), method: :delete %>
              </div>
            <% end %>
          <% end %>
        </div>

        <%= form_with(model:[@post, @comment],url:post_comments_path(@post), method: :POST, local: true) do |f| %>
        <div class="comment_here">
          <%= f.text_area :comment ,placeholder: "コメントをここに", style:"width:500px height:200px;" %>
        </div>
        <div class="comment_button">
          <%= f.submit "送信する" %>
        </div>
        <% end %>
      </div>

    </dv>

    <div class="col-lg-1">
    </div>

  </div>
</container>

<script>
    var map;
    function initMap() {
    var target = document.getElementById('googlemap');
    var empire = {lat: 35.689614, lng: 139.691585};

    map = new google.maps.Map(target, {
      center: empire,
      zoom: 14
    });

    var marker = new google.maps.Marker({
        position: {lat: <%= @post.lat ||= 35.6802117 %>, lng: <%= @post.lng ||=139.7576692 %>},
        map: map,
    });

    };
    google.maps.event.addDomListener(window, 'load', initMap);

  </script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB5wzr3646rP2VFEUQPF-N-SoeyYBPhK-U&callback=initMap&v=weekly" async></script>